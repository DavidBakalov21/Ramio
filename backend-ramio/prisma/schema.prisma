generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model assignment {
  id          BigInt              @id @default(autoincrement())
  title       String
  description String?
  dueDate     DateTime?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime
  courseId    BigInt
  language    assignment_language @default(PYTHON)
  points      Int                 @default(100)

  @@index([courseId], map: "Assignment_courseId_fkey")
}

model assignmentsubmission {
  id              BigInt    @id @default(autoincrement())
  assignmentId    BigInt
  userId          BigInt
  completedAt     DateTime  @default(now())
  points          Int       @default(0)
  teacherFeedback String    @db.LongText
  checkedAt       DateTime?
  isChecked       Boolean   @default(false)

  @@unique([assignmentId, userId], map: "AssignmentSubmission_assignmentId_userId_key")
  @@index([userId], map: "AssignmentSubmission_userId_fkey")
}

model course {
  id          BigInt   @id @default(autoincrement())
  title       String
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  userId      BigInt

  @@index([userId], map: "Course_userId_fkey")
}

model enrollment {
  id         BigInt   @id @default(autoincrement())
  userId     BigInt
  courseId   BigInt
  enrolledAt DateTime @default(now())

  @@unique([userId, courseId], map: "Enrollment_userId_courseId_key")
  @@index([courseId], map: "Enrollment_courseId_fkey")
}

model pendingenrollment {
  id        BigInt   @id @default(autoincrement())
  userId    BigInt
  courseId  BigInt
  createdAt DateTime @default(now())

  @@unique([userId, courseId], map: "PendingEnrollment_userId_courseId_key")
  @@index([courseId], map: "PendingEnrollment_courseId_fkey")
}

model submissionfile {
  id           BigInt   @id @default(autoincrement())
  url          String
  key          String
  name         String
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  submissionId BigInt

  @@index([submissionId], map: "SubmissionFile_submissionId_fkey")
}

model testfile {
  id           BigInt   @id @default(autoincrement())
  url          String
  key          String
  name         String
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  assignmentId BigInt   @unique(map: "TestFile_assignmentId_key")
}

model user {
  id                BigInt     @id @default(autoincrement())
  cognitoSub        String     @unique(map: "User_cognitoSub_key")
  email             String     @unique(map: "User_email_key")
  role              user_role?
  username          String?
  profilePictureUrl String?
  createdAt         DateTime   @default(now())
  updatedAt         DateTime
  countryCode       String?
  aboutMe           String?    @db.LongText
  birthdate         DateTime?
}

enum user_role {
  STUDENT
  TEACHER
}

enum assignment_language {
  PYTHON
  NODE_JS
}
